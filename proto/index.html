<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>–°–∫–ª–∞–¥ ‚Äî –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã (–ü—Ä–æ—Ç–æ—Ç–∏–ø)</title>
    <link href="styles.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body class="dark">
<header class="topbar">
    <div class="topbar-inner">
        <div class="brand">
            <div class="logo">TenderBotStore</div>
            <div class="brand-badge">–û—á–µ–Ω—å –Ω–æ–≤—ã–π –±—Ä–µ–Ω–¥</div>
        </div>

        <nav class="topnav">
            <a href="#">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="#">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º</a>
            <a href="#">–ö—É—Ö–Ω—è</a>
            <a href="#">–ö–∞—Å—Å–∞</a>
            <a href="#">–ó–∞–∫–∞–∑—ã</a>
            <a href="#">–ê–¥–º–∏–Ω</a>
        </nav>

        <div class="top-actions">
            <div class="user">rillgd / –û—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ ‚ñæ</div>
            <button aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É" class="btn small" id="themeToggle">üåô</button>
        </div>
    </div>
</header>

<main class="inventory dark-surface">
    <div class="page-header">
        <h1 id="pageTitle">–°–∫–ª–∞–¥: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π</h1>
        <div class="page-controls">
            <input class="search" placeholder="–ü–æ–∏—Å–∫ (id, –∫–ª–∏–µ–Ω—Ç, –±—Ä–µ–Ω–¥)"/>
            <select aria-label="–í—ã–±–æ—Ä —Å–∫–ª–∞–¥–∞" id="warehouseSelect">
                <option value="central">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π</option>
                <option value="kitchen2">–ö—É—Ö–Ω—è ‚Ññ2</option>
                <option value="warehouse3">–°–∫–ª–∞–¥ 3</option>
            </select>
            <input type="date"/>
            <button class="btn primary" id="addBtn">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</button>
        </div>
    </div>

    <!-- Warehouse tabs -->
    <div class="warehouse-tabs-wrap">
        <div aria-label="–í—ã–±–æ—Ä —Å–∫–ª–∞–¥–∞" class="warehouse-tabs" role="tablist">
            <button aria-selected="true" class="warehouse-tab active" data-warehouse="central" role="tab">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π
            </button>
            <button aria-selected="false" class="warehouse-tab" data-warehouse="kitchen2" role="tab">–ö—É—Ö–Ω—è ‚Ññ2</button>
            <button aria-selected="false" class="warehouse-tab" data-warehouse="warehouse3" role="tab">–°–∫–ª–∞–¥ 3</button>
        </div>
        <button class="btn small" id="addWarehouseBtn" title="–î–æ–±–∞–≤–∏—Ç—å —Å–∫–ª–∞–¥">Ôºã</button>
    </div>

    <section class="table-wrap">
        <table aria-describedby="table-desc" class="items-table">
            <caption class="sr-only" id="table-desc">–¢–∞–±–ª–∏—Ü–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤</caption>
            <thead>
            <tr>
                <th>ID</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–¢–µ–∫. –∫–æ–ª-–≤–æ</th>
                <th>–ï–¥. –∏–∑–º.</th>
                <th>–°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏</th>
                <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ—Å—Ç–∞–≤–∫–∞</th>
                <th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</th>
                <th>–ü–æ—Å—Ç–∞–≤—â–∏–∫</th>
                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
            </thead>
            <tbody>
            <tr class="row" data-warehouse="central">
                <td class="muted">11</td>
                <td>–†–∏—Å</td>
                <td>12</td>
                <td>–∫–≥</td>
                <td>2025-11-01</td>
                <td>2025-09-23</td>
                <td>2025-10-02</td>
                <td>–û–û–û "–ê–∑–∏—è–§—É–¥"</td>
                <td>–ö—Ä—É–ø—ã</td>
                <td class="actions">
                    <button class="btn small">–°–æ–æ–±—â–µ–Ω–∏–µ</button>
                    <button class="btn outline small">–û—Ç–∑—ã–≤</button>
                </td>
            </tr>

            <tr class="row low-stock" data-warehouse="kitchen2">
                <td class="muted">10</td>
                <td>–ú–æ–ª–æ–∫–æ</td>
                <td>4</td>
                <td>–ª</td>
                <td>2025-10-15</td>
                <td>2025-10-01</td>
                <td>2025-10-09</td>
                <td>–ó–ê–û "–ú–æ–ª–ö–æ–º"</td>
                <td>–ú–æ–ª–æ—á–Ω—ã–µ</td>
                <td class="actions">
                    <button class="btn small">–°–æ–æ–±—â–µ–Ω–∏–µ</button>
                    <button class="btn outline small">–û—Ç–∑—ã–≤</button>
                </td>
            </tr>

            <tr class="row expired" data-warehouse="central">
                <td class="muted">9</td>
                <td>–°—ã—Ä (–ü–∞—Ä–º–µ–∑–∞–Ω)</td>
                <td>2</td>
                <td>–∫–≥</td>
                <td>2024-09-01</td>
                <td>2024-08-20</td>
                <td>2024-09-15</td>
                <td>–û–û–û "–ï–≤—Ä–æ–§—É–¥"</td>
                <td>–°—ã—Ä—ã</td>
                <td class="actions">
                    <button class="btn small">–°–æ–æ–±—â–µ–Ω–∏–µ</button>
                    <button class="btn outline small">–û—Ç–∑—ã–≤</button>
                </td>
            </tr>
            </tbody>
        </table>

        <div class="table-footer">
            <div class="pager">
                <button class="btn outline small">–ù–∞–∑–∞–¥</button>
                <span class="muted">–°—Ç—Ä. 1 –∏–∑ 1</span>
                <button class="btn outline small">–í–ø–µ—Ä—ë–¥</button>
            </div>

            <div class="perpage">
                <label>10
                    <select>
                        <option>10</option>
                        <option>25</option>
                        <option>50</option>
                    </select>
                </label>
            </div>
        </div>
    </section>

    <footer class="legend">
        <div><span class="chip low"></span> –ú–∞–ª–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</div>
        <div><span class="chip expired"></span> –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</div>
    </footer>
</main>

<script>
    // Theme toggle with persistence
    (function () {
        const THEME_KEY = 'site-theme';
        const btn = document.getElementById('themeToggle');
        const addBtn = document.getElementById('addBtn');

        function applyTheme(theme) {
            document.body.classList.toggle('light', theme === 'light');
            document.body.classList.toggle('dark', theme === 'dark');
            if (btn) btn.textContent = (theme === 'light') ? '‚òÄÔ∏è' : 'üåô';
        }

        // init theme
        const saved = localStorage.getItem(THEME_KEY);
        const initial = saved || (document.body.classList.contains('light') ? 'light' : 'dark');
        applyTheme(initial);

        if (btn) {
            btn.addEventListener('click', () => {
                const current = document.body.classList.contains('light') ? 'light' : 'dark';
                const next = current === 'light' ? 'dark' : 'light';
                applyTheme(next);
                localStorage.setItem(THEME_KEY, next);
            });
        }

        if (addBtn) {
            addBtn.addEventListener('click', function () {
                alert('–ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è —Ñ–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ (–¥–µ–º–æ)');
            });
        }

        // Warehouse tabs logic: sync select and tabs, filter table rows
        const warehouseSelect = document.getElementById('warehouseSelect');
        const tabs = document.querySelectorAll('.warehouse-tab');
        const pageTitle = document.getElementById('pageTitle');

        function setActiveWarehouse(key, label) {
            tabs.forEach(t => {
                const k = t.getAttribute('data-warehouse');
                const active = k === key;
                t.classList.toggle('active', active);
                t.setAttribute('aria-selected', active ? 'true' : 'false');
            });
            if (warehouseSelect) warehouseSelect.value = key;
            if (pageTitle && label) pageTitle.textContent = '–°–∫–ª–∞–¥: ' + label;
            filterRowsByWarehouse(key);
        }

        function filterRowsByWarehouse(key) {
            const rows = document.querySelectorAll('.items-table tbody tr');
            rows.forEach(r => {
                // rows can have data-warehouse attribute; default show if blank
                const w = r.getAttribute('data-warehouse') || 'central';
                r.style.display = (w === key) ? '' : 'none';
            });
        }

        tabs.forEach(t => t.addEventListener('click', () => {
            const key = t.getAttribute('data-warehouse');
            const label = t.textContent.trim();
            setActiveWarehouse(key, label);
        }));

        if (warehouseSelect) {
            warehouseSelect.addEventListener('change', () => {
                const selected = warehouseSelect.value;
                const label = warehouseSelect.options[warehouseSelect.selectedIndex].text;
                setActiveWarehouse(selected, label);
            });
        }

        // initialize
        setActiveWarehouse(warehouseSelect ? warehouseSelect.value : 'central', (warehouseSelect ? warehouseSelect.options[warehouseSelect.selectedIndex].text : '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π'));
    })();

    // Modals: warehouse create and ingredient create
    (function () {
        // create modal elements
        const body = document.body;

        // warehouse modal
        const warehouseModalHtml = `
        <div id="warehouseModal" class="modal" aria-hidden="true">
          <div class="modal-dialog">
            <h3>–°–æ–∑–¥–∞—Ç—å —Å–∫–ª–∞–¥</h3>
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞<br/><input id="newWarehouseName" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"/></label>
            <div class="modal-actions">
              <button id="createWarehouse" class="btn primary">–°–æ–∑–¥–∞—Ç—å</button>
              <button id="cancelWarehouse" class="btn outline">–û—Ç–º–µ–Ω–∞</button>
            </div>
          </div>
        </div>`;

        // ingredient modal
        const ingredientModalHtml = `
        <div id="ingredientModal" class="modal" aria-hidden="true">
          <div class="modal-dialog modal-large">
            <h3>–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç</h3>
            <div class="grid-2">
              <label>–ù–∞–∑–≤–∞–Ω–∏–µ<br/><input id="ingName" type="text"/></label>
              <label>–ï–¥. –∏–∑–º.<br/><input id="ingUnit" type="text" placeholder="e.g. –∫–≥"/></label>
              <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è<br/><input id="ingCategory" type="text"/></label>
              <label>–ü–æ—Å—Ç–∞–≤—â–∏–∫<br/><input id="ingSupplier" type="text"/></label>
              <label>–ö–æ–ª-–≤–æ (–Ω–∞—á–∞–ª—å–Ω–æ–µ)<br/><input id="ingQty" type="number" min="0"/></label>
              <label>–°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏<br/><input id="ingExpires" type="date"/></label>
              <label>–ë/–ñ/–£ (–≥ –Ω–∞ 100g)<br/>
                <div style="display:flex;gap:8px"><input id="ingProtein" type="number" placeholder="–ë–µ–ª–∫–∏"/><input id="ingFat" type="number" placeholder="–ñ–∏—Ä—ã"/><input id="ingCarb" type="number" placeholder="–£–≥–ª."/></div>
              </label>
              <label>–û–ø–∏—Å–∞–Ω–∏–µ<br/><textarea id="ingNotes"></textarea></label>
            </div>
            <div class="modal-actions">
              <button id="createIngredient" class="btn primary">–°–æ–∑–¥–∞—Ç—å</button>
              <button id="cancelIngredient" class="btn outline">–û—Ç–º–µ–Ω–∞</button>
            </div>
          </div>
        </div>`;

        body.insertAdjacentHTML('beforeend', warehouseModalHtml + ingredientModalHtml);

        const warehouseModal = document.getElementById('warehouseModal');
        const ingredientModal = document.getElementById('ingredientModal');

        function openModal(modal) {
            modal.setAttribute('aria-hidden', 'false');
            modal.style.display = 'block';
        }

        function closeModal(modal) {
            modal.setAttribute('aria-hidden', 'true');
            modal.style.display = 'none';
        }

        // Add warehouse button
        const addWarehouseBtn = document.getElementById('addWarehouseBtn');
        if (addWarehouseBtn) {
            addWarehouseBtn.addEventListener('click', () => openModal(warehouseModal));
        }

        document.getElementById('cancelWarehouse').addEventListener('click', () => closeModal(warehouseModal));
        document.getElementById('createWarehouse').addEventListener('click', () => {
            const name = document.getElementById('newWarehouseName').value.trim();
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞');
                return;
            }
            // create a key from name
            const key = name.toLowerCase().replace(/[^a-z0-9]+/g, '').slice(0, 20) || ('w' + Date.now());
            // create tab and select option
            const tab = document.createElement('button');
            tab.className = 'warehouse-tab';
            tab.setAttribute('data-warehouse', key);
            tab.textContent = name;
            tab.setAttribute('role', 'tab');
            tab.setAttribute('aria-selected', 'false');
            document.querySelector('.warehouse-tabs').appendChild(tab);
            const option = document.createElement('option');
            option.value = key;
            option.textContent = name;
            document.getElementById('warehouseSelect').appendChild(option);
            // attach listener
            tab.addEventListener('click', () => {
                const label = tab.textContent.trim();
                const k = tab.getAttribute('data-warehouse');
                setActiveWarehouse(k, label);
            });
            // select created
            setActiveWarehouse(key, name);
            closeModal(warehouseModal);
            document.getElementById('newWarehouseName').value = '';
        });

        // open ingredient modal from add button and '+' inline (we'll attach to add button and global + handlers)
        const addIngBtn = document.getElementById('addBtn');
        if (addIngBtn) addIngBtn.addEventListener('click', () => openModal(ingredientModal));

        document.getElementById('cancelIngredient').addEventListener('click', () => closeModal(ingredientModal));
        document.getElementById('createIngredient').addEventListener('click', () => {
            const name = document.getElementById('ingName').value.trim();
            const unit = document.getElementById('ingUnit').value.trim();
            const category = document.getElementById('ingCategory').value.trim();
            const supplier = document.getElementById('ingSupplier').value.trim();
            const qty = parseFloat(document.getElementById('ingQty').value) || 0;
            const expires = document.getElementById('ingExpires').value || '';
            const protein = parseFloat(document.getElementById('ingProtein').value) || 0;
            const fat = parseFloat(document.getElementById('ingFat').value) || 0;
            const carb = parseFloat(document.getElementById('ingCarb').value) || 0;
            const notes = document.getElementById('ingNotes').value.trim();
            if (!name || !unit) {
                alert('–ü–æ–ª—è "–ù–∞–∑–≤–∞–Ω–∏–µ" –∏ "–ï–¥. –∏–∑–º." –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã');
                return;
            }
            // create row in table for currently active warehouse
            const activeTab = document.querySelector('.warehouse-tab.active');
            const warehouseKey = activeTab ? activeTab.getAttribute('data-warehouse') : (document.getElementById('warehouseSelect').value || 'central');
            const id = Math.floor(Math.random() * 10000) + 100;
            const tbody = document.querySelector('.items-table tbody');
            const tr = document.createElement('tr');
            tr.className = 'row';
            tr.setAttribute('data-warehouse', warehouseKey);
            tr.innerHTML = `
          <td class="muted">${id}</td>
          <td>${escapeHtml(name)}</td>
          <td>${qty}</td>
          <td>${escapeHtml(unit)}</td>
          <td>${expires}</td>
          <td>${new Date().toISOString().slice(0, 10)}</td>
          <td>-</td>
          <td>${escapeHtml(supplier)}</td>
          <td>${escapeHtml(category)}</td>
          <td class="actions"><button class="btn small">–°–æ–æ–±—â–µ–Ω–∏–µ</button> <button class="btn outline small">–û—Ç–∑—ã–≤</button></td>
        `;
            tbody.insertBefore(tr, tbody.firstChild);
            closeModal(ingredientModal);
            // clear form
            ['ingName', 'ingUnit', 'ingCategory', 'ingSupplier', 'ingQty', 'ingExpires', 'ingProtein', 'ingFat', 'ingCarb', 'ingNotes'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = '';
            });
        });

        // helper escape
        function escapeHtml(s) {
            return (s + '').replace(/[&<>"']/g, function (c) {
                return {'&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": "&#39;"}[c];
            });
        }
    })();
</script>
</body>
</html>
